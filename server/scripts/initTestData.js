const { PrismaClient } = require('@prisma/client');
const prisma = new PrismaClient();

async function initTestData() {
  console.log('ğŸš€ å¼€å§‹åˆ›å»ºæµ‹è¯•æ•°æ®...');
  
  try {
    // 1. åˆ›å»ºæµ‹è¯•å°è¯´
    console.log('ğŸ“š åˆ›å»ºæµ‹è¯•å°è¯´...');
    const novel = await prisma.novel.upsert({
      where: { id: '1' },
      update: {},
      create: {
        id: '1',
        title: 'ç¥ç§˜ä¾¦æ¢äº‹ä»¶ç°¿',
        description: 'ä¸€ä½ç§äººä¾¦æ¢åœ¨å……æ»¡ç¥ç§˜è‰²å½©çš„åŸå¸‚ä¸­ï¼Œè§£å†³å„ç§ç¦»å¥‡æ¡ˆä»¶çš„æ•…äº‹ã€‚',
        genre: 'æ‚¬ç–‘æ¨ç†',
        rating: 'PG-13',
        status: 'writing'
      }
    });
    console.log('âœ… å°è¯´åˆ›å»ºæˆåŠŸ:', novel.title);

    // 2. åˆ›å»ºæµ‹è¯•è§’è‰²
    console.log('ğŸ‘¥ åˆ›å»ºæµ‹è¯•è§’è‰²...');
    const characters = [
      {
        id: '1',
        novelId: '1',
        name: 'ææ˜',
        description: 'ä¸»è§’ï¼Œç»éªŒä¸°å¯Œçš„ç§äººä¾¦æ¢',
        appearance: 'ä¸­ç­‰èº«æï¼Œæ·±è¤è‰²å¤´å‘ï¼Œæ€»æ˜¯ç©¿ç€æ·±è‰²é£è¡£',
        personality: 'è°¨æ…ä½†å¥½å¥‡å¿ƒå¼ºï¼Œæœ‰è½»å¾®çš„ç¤¾äº¤ææƒ§ç—‡ï¼Œå¯¹ç»†èŠ‚å¼‚å¸¸æ•æ„Ÿ',
        background: 'å‡ºç”Ÿäºå°é•‡ï¼Œçˆ¶äº²å¤±è¸ªäº‹ä»¶è®©ä»–èµ°ä¸Šä¾¦æ¢é“è·¯ã€‚æ›¾ç»æ˜¯è­¦å¯Ÿï¼Œåæ¥è½¬è¡Œåšç§äººä¾¦æ¢ã€‚',
        relationships: JSON.stringify({
          'ç‹è­¦å®˜': 'å¯¼å¸ˆå…³ç³»ï¼Œç´§å¼ ä½†ä¿¡ä»»',
          'å°é›¨': 'åŠ©æ‰‹å…³ç³»ï¼Œç›¸äº’ä¾èµ–',
          'ç¥ç§˜å®¢æˆ·': 'å§”æ‰˜äººï¼Œäº’ç›¸è¯•æ¢'
        }),
        isLocked: false
      },
      {
        id: '2', 
        novelId: '1',
        name: 'ç‹è­¦å®˜',
        description: 'ç»éªŒä¸°å¯Œçš„è€è­¦å¯Ÿï¼Œææ˜çš„å‰åŒäº‹',
        appearance: 'äº”åå¤šå²ï¼ŒèŠ±ç™½å¤´å‘ï¼Œæ€»æ˜¯çš±ç€çœ‰å¤´',
        personality: 'ä¸¥è‚ƒè®¤çœŸï¼ŒæŒ‰è§„åŠäº‹ï¼Œä½†å†…å¿ƒå–„è‰¯',
        background: 'ä»è­¦ä¸‰åå¹´ï¼Œè§è¿‡å„ç§æ¡ˆä»¶ï¼Œæ˜¯ææ˜çš„å¯¼å¸ˆå’Œæœ‹å‹ã€‚',
        relationships: JSON.stringify({
          'ææ˜': 'å¸ˆå¾’å…³ç³»ï¼Œæ—¢æ‹…å¿ƒåˆæ”¯æŒ'
        }),
        isLocked: false
      },
      {
        id: '3',
        novelId: '1', 
        name: 'å°é›¨',
        description: 'ææ˜çš„å¹´è½»åŠ©æ‰‹ï¼Œè®¡ç®—æœºä¸“å®¶',
        appearance: 'äºŒåå¤šå²ï¼ŒçŸ­å‘ï¼Œæ€»æ˜¯æˆ´ç€çœ¼é•œ',
        personality: 'èªæ˜æ´»æ³¼ï¼ŒæŠ€æœ¯èƒ½åŠ›å¼ºï¼Œæœ‰æ—¶è¿‡äºå†²åŠ¨',
        background: 'è®¡ç®—æœºç³»æ¯•ä¸šç”Ÿï¼Œå¶ç„¶æœºä¼šæˆä¸ºææ˜çš„åŠ©æ‰‹ã€‚',
        relationships: JSON.stringify({
          'ææ˜': 'å¸ˆå¾’å…³ç³»ï¼Œæ—¢å´‡æ‹œåˆæƒ³è¯æ˜è‡ªå·±'
        }),
        isLocked: false
      }
    ];

    for (const char of characters) {
      await prisma.character.upsert({
        where: { id: char.id },
        update: char,
        create: char
      });
      console.log('âœ… è§’è‰²åˆ›å»ºæˆåŠŸ:', char.name);
    }

    // 3. åˆ›å»ºæµ‹è¯•ä¸–ç•Œè®¾å®š
    console.log('ğŸŒ åˆ›å»ºæµ‹è¯•ä¸–ç•Œè®¾å®š...');
    const settings = [
      {
        id: '1',
        novelId: '1',
        type: 'location',
        name: 'åºŸå¼ƒå·¥å‚',
        description: 'ä½äºåŸå¸‚éƒŠåŒºçš„åºŸå¼ƒçººç»‡å·¥å‚ï¼Œæˆä¸ºå„ç§ç¥ç§˜äº‹ä»¶çš„å‘ç”Ÿåœ°',
        details: JSON.stringify({
          address: 'åŸå¸‚å—éƒŠå·¥ä¸šåŒº',
          history: 'å»ºäº1960å¹´ä»£ï¼Œ2010å¹´å€’é—­',
          structure: 'ä¸‰å±‚å»ºç­‘ï¼Œåœ°ä¸‹æœ‰ä»“åº“',
          atmosphere: 'é˜´æ£®ææ€–ï¼Œç»å¸¸æœ‰å¥‡æ€ªçš„å£°éŸ³'
        }),
        isLocked: false
      },
      {
        id: '2',
        novelId: '1',
        type: 'location', 
        name: 'è­¦å¯Ÿå±€',
        description: 'å¸‚åŒºè­¦å¯Ÿå±€ï¼Œææ˜ç»å¸¸æ¥è¿™é‡Œå¯»æ±‚å¸®åŠ©',
        details: JSON.stringify({
          address: 'å¸‚ä¸­å¿ƒå»ºå›½è·¯88å·',
          departments: ['åˆ‘ä¾¦ç§‘', 'æ²»å®‰ç§‘', 'äº¤è­¦ç§‘'],
          keyPersons: ['ç‹è­¦å®˜', 'å±€é•¿è€å¼ ']
        }),
        isLocked: false
      },
      {
        id: '3',
        novelId: '1',
        type: 'rule',
        name: 'è°ƒæŸ¥æµç¨‹',
        description: 'ç§äººä¾¦æ¢çš„æ ‡å‡†è°ƒæŸ¥æµç¨‹å’Œè§„èŒƒ',
        details: JSON.stringify({
          steps: [
            'æ¥å—å§”æ‰˜å¹¶ç­¾è®¢åˆåŒ',
            'æ”¶é›†åŸºç¡€ä¿¡æ¯',
            'ç°åœºå‹˜æŸ¥',
            'è®¿è°ˆç›¸å…³äººå‘˜',
            'åˆ†æè¯æ®',
            'å¾—å‡ºç»“è®ºå¹¶æŠ¥å‘Š'
          ],
          principles: ['ä¿æŠ¤å®¢æˆ·éšç§', 'éµå®ˆæ³•å¾‹', 'å®äº‹æ±‚æ˜¯']
        }),
        isLocked: false
      },
      {
        id: '4',
        novelId: '1',
        type: 'worldview',
        name: 'ç°ä»£éƒ½å¸‚èƒŒæ™¯',
        description: 'æ•…äº‹å‘ç”Ÿåœ¨ä¸€ä¸ªç°ä»£åŒ–çš„å¤§éƒ½å¸‚ï¼Œå……æ»¡äº†æœºé‡å’Œå±é™©',
        details: JSON.stringify({
          timeframe: '2020å¹´ä»£',
          technology: 'ç°ä»£ç§‘æŠ€æ°´å¹³',
          society: 'å¿«é€Ÿå‘å±•çš„éƒ½å¸‚ç¤¾ä¼š',
          conflicts: 'ä¼ ç»Ÿä¸ç°ä»£çš„å†²çªï¼Œå¯Œè´«å·®è·'
        }),
        isLocked: false
      }
    ];

    for (const setting of settings) {
      await prisma.worldSetting.upsert({
        where: { id: setting.id },
        update: setting,
        create: setting
      });
      console.log('âœ… è®¾å®šåˆ›å»ºæˆåŠŸ:', setting.name);
    }

    // 4. åˆ›å»ºæµ‹è¯•ç« èŠ‚
    console.log('ğŸ“– åˆ›å»ºæµ‹è¯•ç« èŠ‚...');
    const chapters = [
      {
        id: '1',
        novelId: '1',
        chapterNumber: 1,
        title: 'ç¥ç§˜çš„å¼€å§‹',
        outline: `## å¼€åœºè®¾å®š
- **æ—¶é—´**ï¼šæ·±å¤œ11ç‚¹
- **åœ°ç‚¹**ï¼šåºŸå¼ƒçººç»‡å·¥å‚
- **ä¸»è§’**ï¼šææ˜ï¼ˆç´§å¼ ã€å¥½å¥‡ï¼‰
- **æ°›å›´**ï¼šç¥ç§˜ã€ç´§å¼ ã€ç•¥å¸¦ææ€–

## å…³é”®æƒ…èŠ‚
1. **æ¥å—å§”æ‰˜** - ç¥ç§˜å®¢æˆ·å§”æ‰˜è°ƒæŸ¥å¤±è¸ªæ¡ˆ
2. **æ·±å¤œæ¢æŸ¥** - ç‹¬è‡ªå‰å¾€åºŸå¼ƒå·¥å‚è°ƒæŸ¥
3. **å‘ç°çº¿ç´¢** - åœ¨å·¥å‚ä¸­å‘ç°é‡è¦çº¿ç´¢
4. **é­é‡å±é™©** - æ„å¤–é­é‡ä¸æ˜äººå‘˜å¨èƒ
5. **å‹‰å¼ºè„±é™©** - é€šè¿‡æœºæ™ºå’Œè¿æ°”é€ƒè„±å±é™©
6. **é‡è¦å‘ç°** - å¸¦ç€å…³é”®ä¿¡æ¯å®‰å…¨ç¦»å¼€

## è§’è‰²äº’åŠ¨
- ææ˜å†…å¿ƒç‹¬ç™½å±•ç°æ€§æ ¼ç‰¹ç‚¹
- ä¸ç¯å¢ƒçš„ç´§å¼ äº’åŠ¨
- ç«¥å¹´å›å¿†çš„é—ªå›ç‰‡æ®µ

## é¢„æœŸæ•ˆæœ
- è¥é€ æ‚¬ç–‘ç´§å¼ çš„æ°›å›´
- å»ºç«‹ä¸»è§’äººç‰©å½¢è±¡
- åŸ‹ä¸‹åç»­å‰§æƒ…çš„ä¼ç¬”
- å±•ç¤ºä¾¦æ¢çš„ä¸“ä¸šç´ å…»`,
        content: `# ç¬¬ä¸€ç« ï¼šç¥ç§˜çš„å¼€å§‹

## æ·±å¤œçš„å§”æ‰˜

é›¨æ°´æ•²æ‰“ç€åŠå…¬å®¤çš„çª—æˆ·ï¼Œææ˜ååœ¨ä»–é‚£å¼ ç ´æ—§çš„æ¡Œå­åé¢ï¼Œå‡è§†ç€æ¡Œä¸Šåˆšåˆšæ”¾ä¸‹çš„ä¸€å é’ç¥¨ã€‚ç¥ç§˜çš„å®¢æˆ·å·²ç»ç¦»å¼€äº†ï¼Œåªç•™ä¸‹äº†ä¸€ä¸ªåœ°å€å’Œä¸€å¥è¯ï¼š

*"æ‰¾åˆ°çœŸç›¸ï¼Œä¸è®ºä»£ä»·ã€‚"*

ææ˜æ…¢æ…¢åœ°ç‚¹ç‡ƒä¸€æ”¯é¦™çƒŸï¼ŒçƒŸé›¾åœ¨æ˜æš—çš„åŠå…¬å®¤é‡Œç¼“ç¼“å‡èµ·ã€‚ä¸‰åå²çš„ç§äººä¾¦æ¢ï¼Œç»å†äº†å¤ªå¤šå¥‡æ€ªçš„æ¡ˆå­ï¼Œä½†è¿™ä¸€æ¬¡æ„Ÿè§‰æœ‰äº›ä¸åŒã€‚

## åºŸå¼ƒå·¥å‚çš„ç§˜å¯†

æ·±å¤œåä¸€ç‚¹ï¼Œææ˜æ¥åˆ°äº†åŸå¸‚å—éƒŠçš„åºŸå¼ƒçººç»‡å·¥å‚ã€‚æœˆå…‰é€è¿‡ç ´ç¢çš„ç»ç’ƒæ´’åœ¨åœ°é¢ä¸Šï¼Œå½¢æˆæ–‘é©³çš„å…‰å½±ã€‚

ä»–å°å¿ƒç¿¼ç¿¼åœ°æ¨å¼€é”ˆè¿¹æ–‘æ–‘çš„é“é—¨ï¼Œå‘å‡ºåˆºè€³çš„å±å‘€å£°ã€‚å†…å¿ƒæ·±å¤„ï¼Œä¸€ç§è«åçš„ææƒ§æ„Ÿæ¶Œäº†ä¸Šæ¥â€”â€”è¿™ç§æ„Ÿè§‰ä»–å·²ç»å¾ˆä¹…æ²¡æœ‰è¿‡äº†ã€‚

*è¿™é‡Œåˆ°åº•éšè—ç€ä»€ä¹ˆç§˜å¯†ï¼Ÿ*

## æ„å¤–çš„å‘ç°

åœ¨å·¥å‚çš„è§’è½é‡Œï¼Œææ˜å‘ç°äº†ä¸€äº›å¥‡æ€ªçš„ç—•è¿¹ï¼š

- åœ°é¢ä¸Šæœ‰æ–°é²œçš„è¶³è¿¹
- å¢™è§’å †æ”¾ç€ä¸€äº›ç°ä»£åŒ–çš„è®¾å¤‡
- ç©ºæ°”ä¸­å¼¥æ¼«ç€ä¸€ç§åŒ–å­¦è¯å“çš„å‘³é“

å°±åœ¨ä»–ä»”ç»†æ£€æŸ¥è¿™äº›çº¿ç´¢æ—¶ï¼Œèº«åä¼ æ¥äº†è„šæ­¥å£°...

## å±æœºå››ä¼

*"ä½ ä¸åº”è¯¥æ¥è¿™é‡Œçš„ã€‚"* ä¸€ä¸ªä½æ²‰çš„å£°éŸ³ä»é˜´å½±ä¸­ä¼ æ¥ã€‚

ææ˜è¿…é€Ÿè½¬èº«ï¼Œæ‰‹å·²ç»æ‘¸å‘äº†è…°é—´çš„é˜²ç‹¼å–·é›¾ã€‚å¤šå¹´çš„ä¾¦æ¢ç»éªŒå‘Šè¯‰ä»–ï¼Œç°åœ¨çš„æƒ…å†µéå¸¸å±é™©ã€‚

## å‹‡æ•¢çš„é€ƒè„±

å‡­å€Ÿç€å¯¹åœ°å½¢çš„å¿«é€Ÿåˆ¤æ–­å’Œå¤šå¹´ç§¯ç´¯çš„ç»éªŒï¼Œææ˜æˆåŠŸåœ°ä»åé—¨é€ƒè„±äº†ã€‚è™½ç„¶æ²¡æœ‰çœ‹æ¸…è¿½è¸ªè€…çš„é¢ç›®ï¼Œä½†ä»–å·²ç»æ”¶é›†åˆ°äº†è¶³å¤Ÿçš„ä¿¡æ¯ã€‚

å›åˆ°è½¦ä¸Šï¼Œææ˜çš„å¿ƒè·³ä»ç„¶å¾ˆå¿«ã€‚è¿™ä¸ªæ¡ˆå­è¿œæ¯”ä»–æƒ³è±¡çš„å¤æ‚ï¼Œä½†åŒæ—¶ä¹Ÿæ¿€å‘äº†ä»–å†…å¿ƒæ·±å¤„çš„å¥½å¥‡å¿ƒå’Œæ­£ä¹‰æ„Ÿã€‚

*çœŸç›¸ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿæ˜å¤©æˆ‘å¿…é¡»æ‰¾ç‹è­¦å®˜å•†é‡ä¸€ä¸‹...*

---

**[æ’å›¾ä½ç½®æ ‡è®°ï¼šä¸»è§’åœ¨æœˆå…‰ä¸‹è§‚å¯ŸåºŸå¼ƒå·¥å‚çš„å‰ªå½±]**`,
        plotPoints: JSON.stringify([
          { type: 'discovery', description: 'æ¥å—ç¥ç§˜å®¢æˆ·çš„å§”æ‰˜' },
          { type: 'action', description: 'æ·±å¤œå‰å¾€åºŸå¼ƒå·¥å‚è°ƒæŸ¥' },
          { type: 'discovery', description: 'å‘ç°å¯ç–‘çš„çº¿ç´¢å’Œè®¾å¤‡' },
          { type: 'conflict', description: 'é­é‡ä¸æ˜èº«ä»½çš„å¨èƒè€…' },
          { type: 'action', description: 'æœºæ™ºé€ƒè„±å±é™©æƒ…å†µ' },
          { type: 'emotion', description: 'å†…å¿ƒçš„ææƒ§å’Œå¥½å¥‡å¿ƒäº¤ç»‡' }
        ]),
        illustrations: JSON.stringify([
          { position: 'beginning', description: 'ææ˜åœ¨æ˜æš—åŠå…¬å®¤ä¸­å‡è§†å§”æ‰˜è´¹' },
          { position: 'middle', description: 'åºŸå¼ƒå·¥å‚å¤–è§‚ï¼Œæœˆå…‰ä¸‹æ˜¾å¾—é˜´æ£®' },
          { position: 'end', description: 'ä¸»è§’ååœ¨è½¦ä¸­æ€è€ƒï¼Œé€è¿‡è½¦çª—çœ‹å‘å·¥å‚' }
        ]),
        status: 'completed'
      },
      {
        id: '2',
        novelId: '1',
        chapterNumber: 2,
        title: 'å¯»æ±‚æ´åŠ©',
        outline: `## å¼€åœºè®¾å®š
- **æ—¶é—´**ï¼šç¬¬äºŒå¤©ä¸Šåˆ
- **åœ°ç‚¹**ï¼šå¸‚åŒºè­¦å¯Ÿå±€
- **ä¸»è§’**ï¼šææ˜ï¼ˆç–²æƒ«ä½†å†³å¿ƒåšå®šï¼‰
- **é…è§’**ï¼šç‹è­¦å®˜

## å…³é”®æƒ…èŠ‚
1. **æ±‡æŠ¥æƒ…å†µ** - å‘ç‹è­¦å®˜æ±‡æŠ¥æ˜¨å¤œçš„å‘ç°
2. **åˆ†æçº¿ç´¢** - å…±åŒåˆ†ææ”¶é›†åˆ°çš„ä¿¡æ¯
3. **è·å¾—å¸®åŠ©** - ç‹è­¦å®˜æä¾›å®˜æ–¹æ”¯æŒ
4. **åˆ¶å®šè®¡åˆ’** - è®¨è®ºä¸‹ä¸€æ­¥è°ƒæŸ¥æ–¹æ¡ˆ`,
        content: `# ç¬¬äºŒç« ï¼šå¯»æ±‚æ´åŠ©

## è­¦å¯Ÿå±€çš„æ—©æ™¨

ç¬¬äºŒå¤©ä¸€æ—©ï¼Œææ˜å°±æ¥åˆ°äº†å¸‚åŒºè­¦å¯Ÿå±€ã€‚ç‹è­¦å®˜å·²ç»åœ¨åŠå…¬å®¤ç­‰ç€ä»–äº†ï¼Œæ¡Œä¸Šæ”¾ç€ä¸¤æ¯çƒ­æ°”è…¾è…¾çš„å’–å•¡ã€‚

*"çœ‹èµ·æ¥ä½ æ˜¨æ™šæ²¡ç¡å¥½ã€‚"* ç‹è­¦å®˜å…³åˆ‡åœ°è¯´é“ã€‚

## çº¿ç´¢çš„æ±‡æ€»

ææ˜å°†æ˜¨å¤œçš„ç»å†è¯¦ç»†åœ°å‘ç‹è­¦å®˜æ±‡æŠ¥äº†ä¸€éã€‚ç‹è­¦å®˜è®¤çœŸåœ°è®°å½•ç€æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œå¶å°”ä¼šé—®ä¸€äº›å…³é”®é—®é¢˜ã€‚

*"è¿™ä¸ªæ¡ˆå­å¯èƒ½æ¯”æˆ‘ä»¬æƒ³è±¡çš„æ›´å¤æ‚ã€‚"*

ï¼ˆæ­¤ç« èŠ‚å†…å®¹å¾…ç»­...ï¼‰`,
        plotPoints: JSON.stringify([
          { type: 'dialogue', description: 'ä¸ç‹è­¦å®˜è®¨è®ºæ˜¨å¤œçš„å‘ç°' },
          { type: 'discovery', description: 'åˆ†ææ”¶é›†åˆ°çš„çº¿ç´¢' },
          { type: 'action', description: 'åˆ¶å®šä¸‹ä¸€æ­¥è°ƒæŸ¥è®¡åˆ’' }
        ]),
        illustrations: JSON.stringify([
          { position: 'beginning', description: 'è­¦å¯Ÿå±€åŠå…¬å®¤ï¼Œä¸¤äººå¯¹åè®¨è®º' }
        ]),
        status: 'writing'
      }
    ];

    for (const chapter of chapters) {
      await prisma.chapter.upsert({
        where: { id: chapter.id },
        update: chapter,
        create: chapter
      });
      console.log('âœ… ç« èŠ‚åˆ›å»ºæˆåŠŸ:', `ç¬¬${chapter.chapterNumber}ç«  ${chapter.title}`);
    }

    // 5. åˆ›å»ºç« èŠ‚-è§’è‰²å…³è”
    console.log('ğŸ”— åˆ›å»ºç« èŠ‚è§’è‰²å…³è”...');
    const chapterCharacters = [
      { chapterId: '1', characterId: '1', role: 'main' },    // ææ˜æ˜¯ç¬¬ä¸€ç« ä¸»è§’
      { chapterId: '1', characterId: '2', role: 'mentioned' }, // ç‹è­¦å®˜è¢«æåŠ
      { chapterId: '2', characterId: '1', role: 'main' },    // ææ˜æ˜¯ç¬¬äºŒç« ä¸»è§’  
      { chapterId: '2', characterId: '2', role: 'supporting' } // ç‹è­¦å®˜æ˜¯ç¬¬äºŒç« é…è§’
    ];

    for (const relation of chapterCharacters) {
      await prisma.chapterCharacter.upsert({
        where: {
          chapterId_characterId: {
            chapterId: relation.chapterId,
            characterId: relation.characterId
          }
        },
        update: { role: relation.role },
        create: relation
      });
    }
    console.log('âœ… ç« èŠ‚è§’è‰²å…³è”åˆ›å»ºæˆåŠŸ');

    // 6. åˆ›å»ºç« èŠ‚-è®¾å®šå…³è”
    console.log('ğŸŒ åˆ›å»ºç« èŠ‚è®¾å®šå…³è”...');
    const chapterSettings = [
      { chapterId: '1', settingId: '1', usage: 'ä¸»è¦åœºæ™¯ï¼Œè¥é€ ç´§å¼ ç¥ç§˜æ°›å›´' },
      { chapterId: '1', settingId: '3', usage: 'æŒ‡å¯¼ä¸»è§’çš„è°ƒæŸ¥è¡Œä¸º' },
      { chapterId: '1', settingId: '4', usage: 'æ•…äº‹èƒŒæ™¯è®¾å®š' },
      { chapterId: '2', settingId: '2', usage: 'ä¸»è¦åœºæ™¯ï¼Œæä¾›å®‰å…¨æ„Ÿå’Œä¸“ä¸šæ”¯æŒ' }
    ];

    for (const relation of chapterSettings) {
      await prisma.chapterSetting.upsert({
        where: {
          chapterId_settingId: {
            chapterId: relation.chapterId,
            settingId: relation.settingId
          }
        },
        update: { usage: relation.usage },
        create: relation
      });
    }
    console.log('âœ… ç« èŠ‚è®¾å®šå…³è”åˆ›å»ºæˆåŠŸ');

    // 7. åˆ›å»ºAIçº¦æŸè®¾ç½®
    console.log('ğŸ¤– åˆ›å»ºAIçº¦æŸè®¾ç½®...');
    await prisma.aIConstraint.upsert({
      where: { novelId: '1' },
      update: {},
      create: {
        novelId: '1',
        rating: 'PG-13',
        violence: 4,
        romance: 2,
        language: 2,
        customRules: JSON.stringify({
          themes: ['æ‚¬ç–‘æ¨ç†', 'ç°ä»£éƒ½å¸‚', 'æ­£ä¹‰ä¸é‚ªæ¶'],
          forbidden: ['è¿‡åº¦è¡€è…¥', 'éœ²éª¨æå†™', 'æ”¿æ²»æ•æ„Ÿå†…å®¹'],
          emphasis: ['é€»è¾‘æ¨ç†', 'äººç‰©å¿ƒç†', 'ç¯å¢ƒæå†™']
        })
      }
    });
    console.log('âœ… AIçº¦æŸè®¾ç½®åˆ›å»ºæˆåŠŸ');

    console.log('ğŸ‰ æµ‹è¯•æ•°æ®åˆ›å»ºå®Œæˆï¼');
    console.log('\nğŸ“Š æ•°æ®ç»Ÿè®¡ï¼š');
    console.log(`- å°è¯´ï¼š1éƒ¨`);
    console.log(`- è§’è‰²ï¼š${characters.length}ä¸ª`); 
    console.log(`- è®¾å®šï¼š${settings.length}ä¸ª`);
    console.log(`- ç« èŠ‚ï¼š${chapters.length}ç« `);
    
    console.log('\nğŸ”— æµ‹è¯•é“¾æ¥ï¼š');
    console.log('- è·å–ç« èŠ‚1ï¼šGET http://localhost:3001/api/chapters/1');
    console.log('- è·å–ç« èŠ‚2ï¼šGET http://localhost:3001/api/chapters/2');
    console.log('- è·å–å°è¯´ä¿¡æ¯ï¼šGET http://localhost:3001/api/novels/1');
    
  } catch (error) {
    console.error('âŒ åˆ›å»ºæµ‹è¯•æ•°æ®å¤±è´¥:', error);
  } finally {
    await prisma.$disconnect();
  }
}

// å¦‚æœç›´æ¥è¿è¡Œæ­¤è„šæœ¬
if (require.main === module) {
  initTestData();
}

module.exports = { initTestData };
